<?php

namespace Reviews\Database;

class Connection extends \PDO
{
	public static $instance;

	public function __construct($dsn = null, $username = null, $password = null) 
	{
		if (!$dsn) {
			$dsn = 'mysql:host='. DB_HOST .';dbname='. DB_NAME;
		}

		if (!$username) {
			$username = DB_USER;
		}

		if (!$password) {
			$password = DB_PASSWORD;
		}

		parent::__construct($dsn, $username, $password, [
			\PDO::MYSQL_ATTR_INIT_COMMAND => "SET sql_mode=(SELECT REPLACE(@@sql_mode,'ONLY_FULL_GROUP_BY',''))",
		]);
	}

	public static function getInstance() 
	{
		if ( ! static::$instance) {
			static::$instance = new static();
		}

		return static::$instance;
	}
}